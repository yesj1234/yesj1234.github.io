<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<link rel="stylesheet" href="/styles/app.css" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.Bs5QCvu5.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.KdkzbpVi.css" rel="stylesheet">
		<link href="../_app/immutable/assets/ArticleMeta.VMQ7KKaF.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Bt011eEk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.8eFT0ks7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.B-IchvsE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.3KgnaAzN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.BXAsoQ_g.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.mfj6Lk7h.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/each.D6YF6ztN.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.CN2cAEwy.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.CzR0xuCU.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/PageHead.lOwxy8xl.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/ArticleMeta.CnvR0XDo.js"><title>Flutter Package - Riverpod, State management tool | SvelteKit + MDsveX Blog</title><!-- HEAD_svelte-1jfag13_START --><meta property="og:site_name" content="SvelteKit + MDsveX Blog"><meta property="og:title" content="Flutter Package - Riverpod, State management tool"><meta property="og:description" content="Learn the core concept of provider and basic features of Riverpod."><!-- HEAD_svelte-1jfag13_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">  <div class="header-container svelte-8sye89"><div class="sidebarNavBtn svelte-8sye89"><button data-svelte-h="svelte-1w5a5mz"><i class="fa-solid fa-bars"></i></button></div>   <div class="svelte-149edha"><a href="/"><h1 class="small" data-svelte-h="svelte-9gkbac">Jack.dev.blog</h1></a> </div></div> <div class="sidebar-and-main svelte-8sye89"><div class="sidebar-container svelte-8sye89"><aside class="w-64" aria-label="Sidebar"><div class="overflow-y-auto py-4 px-3 bg-gray-50 rounded dark:bg-gray-800"><ul class="space-y-2 list-none"><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Dart"> <span class="ms-3">Dart</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Flutter"> <span class="ms-3">Flutter</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/SvelteKit"> <span class="ms-3">SvelteKit</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Mdsvex"> <span class="ms-3">Mdsvex</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Github"> <span class="ms-3">Github</span> </a></li>  <hr></ul> </div> </aside> </div> <div class="main svelte-8sye89"> <div class="metadata svelte-1nrt46a"><h2 class="heading svelte-1ujuesn large" id="flutter-package--riverpod-state-management-tool"><a href="#flutter-package--riverpod-state-management-tool">Flutter Package - Riverpod, State management tool</a></h2> <p class="svelte-1uy9i9h"><div class="tags svelte-1uy9i9h"><span data-svelte-h="svelte-190wkx9">Tags:</span> <div class="tag-items-container svelte-1uy9i9h"><span class="tag svelte-1uy9i9h">Flutter</span></div></div></p> <div class="metadata svelte-1uy9i9h"><span class="date svelte-1uy9i9h">2024. 11. 08. (Fri)</span> </div></div> <div class="component svelte-1nrt46a"><nav class="toc" data-svelte-h="svelte-l2t9v8"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#state-management">State management</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#state">State</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#riverpod">Riverpod</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#modeling">Modeling</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#provider">Provider</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#consumer">Consumer</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#notifier">Notifier</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#providerobserver">ProviderObserver</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#using-riverpod">Using riverpod</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#install">Install</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#providerscope">ProviderScope</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#define-model">Define model</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#define-provider">Define Provider</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#하드코딩된-위젯-리팩토링-statelesswidget---consumerwidget">하드코딩된 위젯 리팩토링 StatelessWidget -&gt; ConsumerWidget</a></li></ol></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#sources">Sources</a></li></ol></nav> <h1 id="state-management" data-svelte-h="svelte-i2vcbv">State management</h1> <h2 id="state" data-svelte-h="svelte-lby9aw">State</h2> <p data-svelte-h="svelte-70zqg8">Flutter를 이용한 앱개발의 관점에서 상태(State)라는 용어는 일반적으로 다음과 같은 것들을 의미합니다.</p> <ul data-svelte-h="svelte-fa5mif"><li>버튼의 클릭 상태나 애니메이션의 진행 상태와 같이 앱의 한 곳에서만 사용되는 Local state</li> <li>로그인 상태나 환경 변수와 같이 앱 전반에 걸쳐 사용되는 Global state</li></ul> <p data-svelte-h="svelte-q12vd1">Local state는 app의 다른 곳에서 같은 정보를 사용할 일이 없는 정보이기 때문에 딱히 관리라고 할 것이 필요가 없습니다.</p> <p data-svelte-h="svelte-lhvh57">Global state는 반대로 state의 정보를 app의 여러 곳에서 사용합니다.
따라서 state를 일관되게 유지해야 하고 state에 변화가 생길 경우의 side-effect를 어떻게 다룰지 고려해야 합니다.</p> <p data-svelte-h="svelte-lfnoup">Flutter는 이러한 Global State를 관리하기위해 InheritedWidget, InheritedModel 등의 기본적인 방법을 제공하지만, Flutter 초보자 입장에서 이것들만을 활용해 상태를 관리하기란 쉽지 않습니다.</p> <p data-svelte-h="svelte-1szcokm">그래서 Flutter는 Provider라는 패키지를 사용할 것을 추천하고 있습니다만, Provider를 좀 더 쉽게 사용할 수 있게끔 만든 Riverpod에 대해 알아보고자 합니다. (Provider와 Riverpod 모두 <a href="https://github.com/rrousselGit" rel="nofollow">Remi Rousselet</a>가 만들었습니다.)</p> <hr> <h2 id="riverpod" data-svelte-h="svelte-ni8ciy">Riverpod</h2> <p data-svelte-h="svelte-16qybcj">Riverpod 은 Provider를 기반으로 만든 Flutter 앱을 위한 반응형 캐싱 프레임워크입니다.</p> <p data-svelte-h="svelte-5j1eyi">Riverpod은 Flutter와 마찬가지로 선언적인(declarative) 프로그래밍 방법으로 앱에 필요한 상당 부분을 대신 해결해줍니다.</p> <p data-svelte-h="svelte-crz7it">예를 들면, 네트워크 요청시에</p> <ul data-svelte-h="svelte-10t8yss"><li>Handling error and loading status</li> <li>Caching</li> <li>Automatic re-fetching when necessary</li></ul> <p data-svelte-h="svelte-nnbntm">또한 앱의 규모가 커짐에 따라 필요해지는 기능들, 예를 들어</p> <ul data-svelte-h="svelte-hea9w4"><li>Pull to refresh (당겨서 새로고침)</li> <li>Infinite lists / fetch as we scroll (무한 스크롤)</li> <li>Search as we type (검색)</li> <li>Debouncing asynchronous requests (비동기요청 묶음 처리)</li> <li>Cancelling asynchronous requests when no-longer used (사용되지 않는 비동기 요청 취소)</li> <li>Optimistic UIs (실패할 확률이 낮은 요청에 대한 낙관적인 페이지 처리)</li> <li>Offline mode (비행기 모드)</li></ul> <p data-svelte-h="svelte-ildcbr">Riverpod은 Provider를 통한 상태관리와 위처럼 그에 관련된 여러 가지 문제 상황들을 해결하고자 나온 패키지라고 볼 수 있겠습니다.</p> <hr> <p data-svelte-h="svelte-132ikd8"><img src="/core_concepts.jpg" alt="core_concpets"></p> <p data-svelte-h="svelte-1bkku1c">Riverpod의 가장 근본적인 기능인 상태관리와 관련된 핵심적인 부분들에 대해 먼저 알아보겠습니다.</p> <p data-svelte-h="svelte-1ne495">다음과 같은 상황을 가정해 보겠습니다.</p> <p data-svelte-h="svelte-1qvldm8">야외 활동과 관련된 앱을 만드는데 다음과 같은 요구사항이 생겼습니다.</p> <ol data-svelte-h="svelte-1ur2q5k"><li>데이터는 외부 서버로부터 받아와서 사용해야 함</li> <li>받아온 데이터는 캐싱되어야 하며</li> <li>네트워크 요청시 Error / loading 상태를 고려하여야함</li> <li>데이터에 변동이 있을 경우 데이터를 업데이트 해야함</li></ol> <p data-svelte-h="svelte-mlqrg8">받아올 데이터(Activity)는 다음과 같은 정보를 포함해야 합니다.</p> <ol data-svelte-h="svelte-1qyxvn0"><li>key</li> <li>activity</li> <li>type</li> <li>participants</li> <li>price</li></ol> <h3 id="modeling" data-svelte-h="svelte-wfoia0">Modeling</h3> <p data-svelte-h="svelte-6p0k86">JSON 데이터를 Flutter앱에서 안전하게 사용하기 위해서는 Dart class 객체로 변환하여 사용하는 것이 좋습니다.
JSON decoding을 할 때는 일반적으로 Freezed나 json_serializable 같은 code generator 패키지를 많이 사용합니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:freezed_annotation/freezed_annotation.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">part</span> <span class="token string-literal"><span class="token string">'activity.freezed.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">part</span> <span class="token string-literal"><span class="token string">'activity.g.dart'</span></span><span class="token punctuation">;</span>

<span class="token comment">/// The response of the &#96;GET /api/activity&#96; endpoint.</span>
<span class="token comment">///</span>
<span class="token comment">/// It is defined using &#96;freezed&#96; and &#96;json_serializable&#96;.</span>
<span class="token metadata function">@freezed</span>
<span class="token keyword">class</span> <span class="token class-name">Activity</span> <span class="token keyword">with</span> _$<span class="token class-name">Activity</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">factory</span> <span class="token class-name">Activity</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    required <span class="token class-name">String</span> key<span class="token punctuation">,</span>
    required <span class="token class-name">String</span> activity<span class="token punctuation">,</span>
    required <span class="token class-name">String</span> type<span class="token punctuation">,</span>
    required int participants<span class="token punctuation">,</span>
    required double price<span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=</span> _Activity<span class="token punctuation">;</span>

  <span class="token comment">/// Convert a JSON object into an [Activity] instance.</span>
  <span class="token comment">/// This enables type-safe reading of the API response.</span>
  <span class="token keyword">factory</span> <span class="token class-name">Activity</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">></span></span> json<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> _$<span class="token class-name">ActivityFromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-103gzo4">freezed에 대한 부분은 따로 정리하도록 하고 여기선 넘어가겠습니다.</p> <p data-svelte-h="svelte-1ols49t">이제 JSON 데이터를 안전하게 받아올 Model이 생겼으니 이 데이터를 제공해줄 Provider를 만들어 보도록 하겠습니다.</p> <hr> <h3 id="provider" data-svelte-h="svelte-s1lvzw">Provider</h3> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter_riverpod/flutter_riverpod.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:http/http.dart'</span></span> <span class="token operator">as</span> http<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:riverpod_annotation/riverpod_annotation.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'activity.dart'</span></span><span class="token punctuation">;</span>

<span class="token comment">// Necessary for code-generation to work</span>
<span class="token keyword">part</span> <span class="token string-literal"><span class="token string">'provider.g.dart'</span></span><span class="token punctuation">;</span>

<span class="token comment">/// This will create a provider named &#96;activityProvider&#96;</span>
<span class="token comment">/// which will cache the result of this function.</span>
<span class="token metadata function">@riverpod</span>
<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Activity</span><span class="token punctuation">></span></span> <span class="token function">activity</span><span class="token punctuation">(</span><span class="token class-name">Ref</span> ref<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// Using package:http, we fetch a random activity from the Bored API.</span>
  <span class="token keyword">final</span> response <span class="token operator">=</span> <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'boredapi.com'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'/api/activity'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Using dart:convert, we then decode the JSON payload into a Map data structure.</span>
  <span class="token keyword">final</span> json <span class="token operator">=</span> <span class="token function">jsonDecode</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token comment">// Finally, we convert the Map into an Activity instance.</span>
  <span class="token keyword">return</span> <span class="token class-name">Activity</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-14gtamk"><strong>@riverpod</strong> <strong>(OR @Riverpod)</strong></p> <p data-svelte-h="svelte-1ldfyej">Provider를 만들 때는 반드시 @riverpod 혹은 @Riverpod() annotation을 포함해야 합니다.</p> <p data-svelte-h="svelte-5wnm4b">@Riverpod() annotation을 사용하여 provider 관련 옵션(auto-dispose등의)을 설정할 수 있습니다.</p> <p data-svelte-h="svelte-g6367s"><strong>Future activity(Ref ref) async</strong></p> <p data-svelte-h="svelte-1130bif">함수의 이름이 activity이기 때문에 activityProvider 변수가 자동으로 생성됩니다(code-generation이 설정되어 있다면).</p> <p data-svelte-h="svelte-jwa8ph">함수는 반드시 첫 번째 파라미터로 “ref”를 사용해야합니다.</p> <p data-svelte-h="svelte-gdxt7b">generic을 포함한 다른 parameter들, optional parameter, named parameter등 자유롭게 설정 할 수 있으며 return type 또한 자유롭게 설정할 수 있습니다.</p> <p data-svelte-h="svelte-1uys69w">이 Provider는 처음 사용되는 시점에 실행되며 이후에는 캐시된 값을 리턴합니다.</p> <p data-svelte-h="svelte-1pwzs58"><strong>Ref</strong></p> <p data-svelte-h="svelte-1tty2z0">다른 Provider들을 사용하기 위한 object입니다.</p> <p data-svelte-h="svelte-cc3gez">모든 Provider들이 ref object를 갖고 있습니다.
위처럼 함수형으로 선언된 Provider는 파라미터로, class로 선언된 Provider는 property로 갖습니다.</p> <p data-svelte-h="svelte-22huhj">코드는 굉장히 간단하지만 염두에 두어야 할 숨겨진 사항이 몇 가지 있습니다.</p> <ul data-svelte-h="svelte-s0cpd"><li>UI에서 provider를 최소한 한번 사용할 때까진 실제 네트워크 요청이 이뤄지지 않습니다.</li> <li>이후 다른 UI에서 provider를 호출할 경우, provider는 새로운 네트워크 요청의 결과값을 반환하는 것이 아니라 캐시된 데이터를 반환합니다.</li> <li>코드의 어떤 부분에서도 Error handling에 관련된 부분이 없지만 Riverpod이 자동으로 처리해줍니다.</li></ul> <hr> <h3 id="consumer" data-svelte-h="svelte-18t47p8">Consumer</h3> <p data-svelte-h="svelte-1n7xt5a">이제 일관된 정보를 전달해줄 Provider를 정의했으니 가져다 쓸 수 있습니다.</p> <p data-svelte-h="svelte-ugte80">Provider를 사용하기 위해서는 Ref object가 필요하다고 했습니다.
Provider를 정의할 때는 ref를 parameter 혹은 class property로 가지고 있었지만 실제 Provider를 쓰는 Widget의 입장에서는 어떻게 ref를 받아와야 할까요?</p> <p data-svelte-h="svelte-h553ky"><code>Consumer</code> 를 사용하면 됩니다.
<code>Consumer</code> 는 Builder에 ref를 추가한 위젯이라고 생각할 수 있습니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/material.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter_riverpod/flutter_riverpod.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'activity.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'provider.dart'</span></span><span class="token punctuation">;</span>

<span class="token comment">/// The homepage of our application</span>
<span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token class-name">Home</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">.</span>key<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span>
      builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">final</span> <span class="token class-name">AsyncValue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Activity</span><span class="token punctuation">></span></span> activity <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>activityProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>
          child<span class="token punctuation">:</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span>activity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">AsyncData</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token keyword">final</span> value<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Activity: </span><span class="token interpolation"><span class="token punctuation">$&#123;</span><span class="token expression">value<span class="token punctuation">.</span>activity</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">AsyncError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">const</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Oops, something unexpected happened'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">const</span> <span class="token class-name">CircularProgressIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-11o9i1s"><strong>final AsyncValue activity = ref.watch(activityProvider);</strong></p> <p data-svelte-h="svelte-1whs5hc">Consumer가 제공해주는 ref의 watch 메서드를 통해 activityProvider가 제공하는 State의 정보를 읽어옵니다.
ref.watch 메서드는 정보를 읽어오는데 그치지 않고 추가적으로 다음과 같은 경우에 widget을 업데이트합니다.</p> <ul data-svelte-h="svelte-7q1pjl"><li>loading -&gt; data or error</li> <li>request 새로고침</li> <li>activityProvider가 제공하는 state의 값이 바뀌었을 때 (by side-effect)</li></ul> <p data-svelte-h="svelte-o02fk1"><strong>switch (activity)</strong></p> <p data-svelte-h="svelte-cka0na">네트워크 요청의 로딩상태 / 성공 / 실패 의 경우에 맞게 알맞은 UI를 그릴 수 있도록 경우를 나눈 것입니다.</p> <hr> <h3 id="notifier" data-svelte-h="svelte-btc5xc">Notifier</h3> <p data-svelte-h="svelte-1mg9e3z">외부 서버의 API를 이용해 데이터를 읽어오는 것은 어떻게 하는지 알았습니다.</p> <p data-svelte-h="svelte-c0idiw">하지만 데이터를 읽어오기만 해서는 의미가 없습니다.
데이터를 추가하거나 변경하거나 삭제할 수도 있어야하죠.
이를 수행하기 위해서는 Notifier가 필요합니다.</p> <p data-svelte-h="svelte-ho4sf">Notifier를 좀 더 쉽게 이해하기 위해 todo list를 만든다고 가정해봅시다.</p> <p data-svelte-h="svelte-1jbcdr4">마찬가지로 Provider를 먼저 정의하도록 하겠습니다.</p> <p data-svelte-h="svelte-1vsts58">다음과 같이 Provider를 정의할 경우 Consumer에서 Provider의 state를 변경할 수 있는 방법이 없습니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token comment">// Provider for reading only. No explicit method to modify the data</span>
<span class="token metadata function">@riverpod</span>
<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Todo</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">todoList</span><span class="token punctuation">(</span><span class="token class-name">Ref</span> ref<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// Simulate a network request. This would normally come from a real API</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token class-name">Todo</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Learn Flutter'</span></span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Todo</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Learn Riverpod'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-s2pzkv">Consumer가 Provider의 state를 변경할 수 있도록 만들기 위해서는 다음과 같이 class 형태로 Provider를 정의해주고 명시적으로 변경할 수 있는 수단을 method의 형태로 제공해주어야 합니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token comment">// Notifier that could have explicit method to modify the data</span>
<span class="token metadata function">@riverpod</span>
<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> _$<span class="token class-name">TodoList</span> <span class="token punctuation">&#123;</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Todo</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// The logic we previously had in our FutureProvider is now in the build method.</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
      <span class="token class-name">Todo</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Learn Flutter'</span></span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token class-name">Todo</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Learn Riverpod'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">></span></span> <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token class-name">Todo</span> todo<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'your_api.com'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'/todos'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string-literal"><span class="token string">'Content-Type'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'application/json'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">jsonEncode</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1bjijkg">이 method는 Consumer의 onPressed와 같은 이벤트 콜백에서 사용할 수 있습니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">ConsumerWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token class-name">Example</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">.</span>key<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token class-name">WidgetRef</span> ref<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>
      onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Using "ref.read" combined with "myProvider.notifier", we can</span>
        <span class="token comment">// obtain the class instance of our notifier. This enables us</span>
        <span class="token comment">// to call the "addTodo" method.</span>
        ref
            <span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>todoListProvider<span class="token punctuation">.</span>notifier<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token class-name">Todo</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'This is a new todo'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Add todo'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-mer3vz">Provider의 state를 변경하긴 했지만 cache된 데이터까지 바꾸지는 못했습니다.</p> <p data-svelte-h="svelte-8ybblv">cache된 데이터를 변경해야 해당 state를 사용하고 있는 UI들이 알맞게 바뀔 수 있습니다.
이를 해결하기 위한 방법이 몇 가지 있습니다.</p> <p data-svelte-h="svelte-9ez4sg"><strong>1. POST요청의 결과값을 이용해 state 업데이트하기</strong></p> <p data-svelte-h="svelte-4irb7w"><strong>2. <code>ref.invalidateSelf()</code>로 provider 새로고침하기</strong></p> <p data-svelte-h="svelte-sirwb8"><strong>3. local cache 직접 업데이트하기</strong></p> <p data-svelte-h="svelte-y5ehda">위의 방법들은 각각 장단점이 있습니다.</p> <p data-svelte-h="svelte-a8n4q2">차례대로 보도록 하겠습니다.</p> <p data-svelte-h="svelte-19d6n8g"><strong>첫 번째, POST 요청의 결과값을 이용해 state 업데이트하기</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">></span></span> <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token class-name">Todo</span> todo<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// The POST request will return a List&lt;Todo> matching the new application state</span>
    <span class="token keyword">final</span> response <span class="token operator">=</span> <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'your_api.com'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'/todos'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string-literal"><span class="token string">'Content-Type'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'application/json'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">jsonEncode</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We decode the API response and convert it to a List&lt;Todo></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Todo</span><span class="token punctuation">></span></span> newTodos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">jsonDecode</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">List</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>cast<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Todo</span><span class="token punctuation">.</span>fromJson<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We update the local cache to match the new state.</span>
    <span class="token comment">// This will notify all listeners.</span>
    state <span class="token operator">=</span> <span class="token class-name">AsyncData</span><span class="token punctuation">(</span>newTodos<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-jly3c4"><strong>장점:</strong></p> <ul data-svelte-h="svelte-7f3taw"><li>항상 최신 정보로 state를 유지할 수 있습니다.</li> <li>server가 모든 정보를 제공해주므로 client에서 새로운 todo를 어떻게 추가해야 할지 등을 알 필요가 없습니다.</li> <li>한 번의 네트워크 요청만을 사용합니다.</li></ul> <p data-svelte-h="svelte-1fk8bbr"><strong>단점:</strong></p> <ul data-svelte-h="svelte-1ytdphl"><li>POST요청이 특정 값을 리턴하도록 요구합니다. 즉 서버가 동작하는 방식이 달라진다면 사용 할 수 없는 방법입니다.</li> <li>만약 filtering / sorting 등의 복잡한 로직이 포함된다면 비용이 증가 할 수 있습니다.</li></ul> <p data-svelte-h="svelte-7aye2q"><strong>두 번째, <code>ref.invalidateSelf()</code>로 provider 새로고침하기</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">></span></span> <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token class-name">Todo</span> todo<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// We don't care about the API response</span>
    <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'your_api.com'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'/todos'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string-literal"><span class="token string">'Content-Type'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'application/json'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">jsonEncode</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Once the post request is done, we can mark the local cache as dirty.</span>
    <span class="token comment">// This will cause "build" on our notifier to asynchronously be called again,</span>
    <span class="token comment">// and will notify listeners when doing so.</span>
    ref<span class="token punctuation">.</span><span class="token function">invalidateSelf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// (Optional) We can then wait for the new state to be computed.</span>
    <span class="token comment">// This ensures "addTodo" does not complete until the new state is available.</span>
    <span class="token keyword">await</span> future<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-jly3c4"><strong>장점:</strong></p> <ul data-svelte-h="svelte-zxrexh"><li>첫 번째 방법과 마찬가지로 항상 최신상태로 state를 유지하며, clien는 새로운 todo를 어떻게 추가해야 할지 등을 알 필요가 없습니다.</li> <li>첫 번째 방법과는 다르게 서버로부터 POST요청의 반환값을 사용하여 cache를 업데이트하지 않기 때문에 서버가 요청을 처리하는 방식이 달라져도 괜찮습니다.</li></ul> <p data-svelte-h="svelte-1fk8bbr"><strong>단점:</strong></p> <ul data-svelte-h="svelte-iwuwl9"><li>위의 주석에서 설명했듯이 ref.invalidateSelf()는 새롭게 state 를 build합니다. 즉 POST요청 이후 GET 요청을 한번 더 실행합니다. 네트워크 요청이 많아져서 좋을게 없죠.</li></ul> <p data-svelte-h="svelte-fx2h9r"><strong>세 번째, local cache 직접 업데이트하기</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">></span></span> <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token class-name">Todo</span> todo<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// We don't care about the API response</span>
    <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'your_api.com'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'/todos'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string-literal"><span class="token string">'Content-Type'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'application/json'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">jsonEncode</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We can then manually update the local cache. For this, we'll need to</span>
    <span class="token comment">// obtain the previous state.</span>
    <span class="token comment">// Caution: The previous state may still be loading or in error state.</span>
    <span class="token comment">// A graceful way of handling this would be to read &#96;this.future&#96; instead</span>
    <span class="token comment">// of &#96;this.state&#96;, which would enable awaiting the loading state, and</span>
    <span class="token comment">// throw an error if the state is in error state.</span>
    <span class="token keyword">final</span> previousState <span class="token operator">=</span> <span class="token keyword">await</span> future<span class="token punctuation">;</span>

    <span class="token comment">// We can then update the state, by creating a new state object.</span>
    <span class="token comment">// This will notify all listeners.</span>
    state <span class="token operator">=</span> <span class="token class-name">AsyncData</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>previousState<span class="token punctuation">,</span> todo<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-jly3c4"><strong>장점:</strong></p> <ul data-svelte-h="svelte-1wdfneo"><li>두 번째 방법과 마찬가지로 서버가 요청을 처리하는 방식이 달라져도 괜찮습니다.</li> <li>두 번째 방법과 다르게 네트워크 요청은 한번만 일어납니다.</li></ul> <p data-svelte-h="svelte-1fk8bbr"><strong>단점:</strong></p> <ul data-svelte-h="svelte-1ljugtt"><li>state가 서버의 정보와 항상 같지 않을 수 있습니다.</li> <li>서버가 todo를 저장하는 방식을 알고 있어야 하기 때문에 복잡도가 증가 할 수 있습니다.</li></ul> <hr> <h3 id="providerobserver" data-svelte-h="svelte-121m0so">ProviderObserver</h3> <p data-svelte-h="svelte-1pycefl">Provider에서 발생하는 이벤트들, 에러들을 보기 위해서는 ProviderObserver를 사용하면 됩니다.</p> <p data-svelte-h="svelte-csw4u3">Provider에서 발생하는 이벤트들에는 다음과 같은 것들이 있습니다.</p> <ul data-svelte-h="svelte-1g2gzra"><li>didAddProvider : provider가 tree에 추가 되었을 때</li> <li>didUpdateProvider : provider가 update되었을 때</li> <li>didDisposeProvider : provider가 해제(dispose) 되었을 때</li> <li>providerDidFail : async provider가 에러를 반환했을 때</li></ul> <p data-svelte-h="svelte-dad8eh">ProviderObserver 만들기</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">MyObserver</span> <span class="token keyword">extends</span> <span class="token class-name">ProviderObserver</span> <span class="token punctuation">&#123;</span>
  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">didAddProvider</span><span class="token punctuation">(</span>
    <span class="token class-name">ProviderBase</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token operator">?</span><span class="token punctuation">></span></span> provider<span class="token punctuation">,</span>
    <span class="token class-name">Object</span><span class="token operator">?</span> value<span class="token punctuation">,</span>
    <span class="token class-name">ProviderContainer</span> container<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Provider </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">provider</span></span><span class="token string"> was initialized with </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">value</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">didDisposeProvider</span><span class="token punctuation">(</span>
    <span class="token class-name">ProviderBase</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token operator">?</span><span class="token punctuation">></span></span> provider<span class="token punctuation">,</span>
    <span class="token class-name">ProviderContainer</span> container<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Provider </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">provider</span></span><span class="token string"> was disposed'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">didUpdateProvider</span><span class="token punctuation">(</span>
    <span class="token class-name">ProviderBase</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token operator">?</span><span class="token punctuation">></span></span> provider<span class="token punctuation">,</span>
    <span class="token class-name">Object</span><span class="token operator">?</span> previousValue<span class="token punctuation">,</span>
    <span class="token class-name">Object</span><span class="token operator">?</span> newValue<span class="token punctuation">,</span>
    <span class="token class-name">ProviderContainer</span> container<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Provider </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">provider</span></span><span class="token string"> updated from </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">previousValue</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">newValue</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">providerDidFail</span><span class="token punctuation">(</span>
    <span class="token class-name">ProviderBase</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token operator">?</span><span class="token punctuation">></span></span> provider<span class="token punctuation">,</span>
    <span class="token class-name">Object</span> error<span class="token punctuation">,</span>
    <span class="token class-name">StackTrace</span> stackTrace<span class="token punctuation">,</span>
    <span class="token class-name">ProviderContainer</span> container<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Provider </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">provider</span></span><span class="token string"> threw </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">error</span></span><span class="token string"> at </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">stackTrace</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-17un3sr">만든 ProviderObserver를 사용하기 위해서는 다음과 같이 앱의 최상단에서 등록해주면 됩니다.
ProviderScope에 등록</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token function">runApp</span><span class="token punctuation">(</span>
  <span class="token class-name">ProviderScope</span><span class="token punctuation">(</span>
    observers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token class-name">MyObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    child<span class="token punctuation">:</span> <span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-lw14j1">혹은 ProviderContainer에 등록</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">final</span> container <span class="token operator">=</span> <span class="token class-name">ProviderContainer</span><span class="token punctuation">(</span>
  observers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token class-name">MyObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <hr> <h2 id="using-riverpod" data-svelte-h="svelte-i2fvst">Using riverpod</h2> <h3 id="install" data-svelte-h="svelte-w4qfa6">Install</h3> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">flutter pub add flutter_riverpod
flutter pub add riverpod_annotation
flutter pub add dev<span class="token punctuation">:</span>riverpod_generator
flutter pub add dev<span class="token punctuation">:</span>build_runner
flutter pub add dev<span class="token punctuation">:</span>custom_lint
flutter pub add dev<span class="token punctuation">:</span>riverpod_lint</code><!-- HTML_TAG_END --></pre> <hr> <h3 id="providerscope" data-svelte-h="svelte-1nzekvy">ProviderScope</h3> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
	<span class="token class-name">WidgetsFlutterBinding</span><span class="token punctuation">.</span><span class="token function">ensureInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">await</span> <span class="token class-name">Firebase</span><span class="token punctuation">.</span><span class="token function">initializeApp</span><span class="token punctuation">(</span>
    options<span class="token punctuation">:</span> <span class="token class-name">DefaultFirebaseOptions</span><span class="token punctuation">.</span>currentPlatform<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token class-name">ProviderScope</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> <span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <hr> <h3 id="define-model" data-svelte-h="svelte-1wcmxpl">Define model</h3> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">Journal</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> image<span class="token punctuation">;</span>

  <span class="token class-name">Journal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">Journal</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">></span></span> json<span class="token punctuation">)</span>
      <span class="token punctuation">:</span> title <span class="token operator">=</span> json<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'title'</span></span><span class="token punctuation">]</span> <span class="token operator">as</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
        content <span class="token operator">=</span> json<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'content'</span></span><span class="token punctuation">]</span> <span class="token operator">as</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
        image <span class="token operator">=</span> json<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'image'</span></span><span class="token punctuation">]</span> <span class="token operator">as</span> <span class="token class-name">String</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <hr> <h3 id="define-provider" data-svelte-h="svelte-5qretd">Define Provider</h3> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token metadata function">@riverpod</span>
<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Journal</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">journal</span><span class="token punctuation">(</span><span class="token class-name">Ref</span> ref<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">final</span> db <span class="token operator">=</span> <span class="token class-name">FirebaseFirestore</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token keyword">final</span> journal <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"journals"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'KFq6AjljeCt60J2Evabr'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> result <span class="token operator">=</span> <span class="token keyword">await</span> journal<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DocumentSnapshot</span> doc<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> json <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> journalModel <span class="token operator">=</span> <span class="token class-name">Journal</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> journalModel<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <hr> <h3 id="하드코딩된-위젯-리팩토링-statelesswidget---consumerwidget" data-svelte-h="svelte-fo9du1">하드코딩된 위젯 리팩토링 StatelessWidget -&gt; ConsumerWidget</h3> <p data-svelte-h="svelte-16yhk14"><strong>BEFORE</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> _Content <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token function">_Content</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">.</span>key<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> <span class="token class-name">TextStyle</span> textStyle <span class="token operator">=</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>
      color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">.</span>shade600<span class="token punctuation">,</span>
      fontWeight<span class="token punctuation">:</span> <span class="token class-name">FontWeight</span><span class="token punctuation">.</span>bold<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>
      child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
        mainAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">MainAxisAlignment</span><span class="token punctuation">.</span>center<span class="token punctuation">,</span>
        children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token class-name">Image</span><span class="token punctuation">.</span><span class="token function">asset</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"assets/icons/LogoTemp.png"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">const</span> <span class="token class-name">SizedBox</span><span class="token punctuation">(</span>
            height<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"일지를 작성해보세요"</span></span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> textStyle<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">CardSingle</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token class-name">CardSingle</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">.</span>key<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CardSingle</span><span class="token punctuation">></span></span> <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">_CardSingleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> _CardSingleState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CardSingle</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token class-name">String</span><span class="token operator">?</span> imageURL<span class="token punctuation">;</span>
  <span class="token keyword">final</span> double innerPadding <span class="token operator">=</span> <span class="token number">12.0</span><span class="token punctuation">;</span>

  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">></span></span> <span class="token function">_fetchImageURLs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> storageRef <span class="token operator">=</span> <span class="token class-name">FirebaseStorage</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> url <span class="token operator">=</span>
        <span class="token keyword">await</span> storageRef<span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/grapeFarm.jpg'</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDownloadURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      imageURL <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_fetchImageURLs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> <span class="token class-name">ColorScheme</span> colorScheme <span class="token operator">=</span> <span class="token class-name">Theme</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>colorScheme<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
      mainAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">MainAxisAlignment</span><span class="token punctuation">.</span>center<span class="token punctuation">,</span>
      crossAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">CrossAxisAlignment</span><span class="token punctuation">.</span>start<span class="token punctuation">,</span>
      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">_UpperDatePortion</span><span class="token punctuation">(</span>
          padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
          child<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>
            <span class="token string-literal"><span class="token string">"오늘"</span></span><span class="token punctuation">,</span>
            style<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>fontWeight<span class="token punctuation">:</span> <span class="token class-name">FontWeight</span><span class="token punctuation">.</span>bold<span class="token punctuation">,</span> fontSize<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">ConstrainedBox</span><span class="token punctuation">(</span>
          constraints<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">BoxConstraints</span><span class="token punctuation">(</span>maxHeight<span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">:</span> <span class="token number">325</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          child<span class="token punctuation">:</span> <span class="token class-name">Card</span><span class="token punctuation">(</span>
            color<span class="token punctuation">:</span> colorScheme<span class="token punctuation">.</span>surface<span class="token punctuation">.</span><span class="token function">withOpacity</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            elevation<span class="token punctuation">:</span> <span class="token number">3.0</span><span class="token punctuation">,</span>
            child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
              crossAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">CrossAxisAlignment</span><span class="token punctuation">.</span>start<span class="token punctuation">,</span>
              children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token function">_ImagePortion</span><span class="token punctuation">(</span>padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span> url<span class="token punctuation">:</span> imageURL<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_TextPortion</span><span class="token punctuation">(</span>
                  padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
                  child<span class="token punctuation">:</span> <span class="token class-name">RichText</span><span class="token punctuation">(</span>
                      maxLines<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                      overflow<span class="token punctuation">:</span> <span class="token class-name">TextOverflow</span><span class="token punctuation">.</span>ellipsis<span class="token punctuation">,</span>
                      text<span class="token punctuation">:</span> <span class="token class-name">TextSpan</span><span class="token punctuation">(</span>
                          style<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> colorScheme<span class="token punctuation">.</span>onSurfaceVariant<span class="token punctuation">)</span><span class="token punctuation">,</span>
                          text<span class="token punctuation">:</span>
                              <span class="token string-literal"><span class="token string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. In neque quam, pellentesque eu nisl a, posuere posuere lacus. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. "</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token class-name">Divider</span><span class="token punctuation">(</span>
                  indent<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                  endIndent<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_DatePortion</span><span class="token punctuation">(</span>
                  padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
                  date<span class="token punctuation">:</span> <span class="token class-name">DateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  onEdit<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">debugPrint</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Hello"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-6gffmn"><strong>AFTER</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> _UserContent <span class="token keyword">extends</span> <span class="token class-name">ConsumerWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token class-name">WidgetRef</span> ref<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> journals <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>journalProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">ListView</span><span class="token punctuation">(</span>
        shrinkWrap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        padding<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>top<span class="token punctuation">:</span> <span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        children<span class="token punctuation">:</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span>journals<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token class-name">AsyncData</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token keyword">final</span> value<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">[</span>
              <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> journal <span class="token keyword">in</span> value<span class="token punctuation">)</span>
                <span class="token class-name">Padding</span><span class="token punctuation">(</span>
                  padding<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>top<span class="token punctuation">:</span> <span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  child<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>
                    child<span class="token punctuation">:</span> <span class="token class-name">CardSingle</span><span class="token punctuation">(</span>
                        title<span class="token punctuation">:</span> journal<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
                        content<span class="token punctuation">:</span> journal<span class="token punctuation">.</span>content<span class="token punctuation">,</span>
                        createdAt<span class="token punctuation">:</span> journal<span class="token punctuation">.</span>createdAt<span class="token punctuation">,</span>
                        image<span class="token punctuation">:</span> journal<span class="token punctuation">.</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token class-name">AsyncError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token keyword">const</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Oops! Something went wrong"</span></span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          _ <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token keyword">const</span> <span class="token class-name">CircularProgressIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">CardSingle</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token class-name">CardSingle</span><span class="token punctuation">(</span>
      <span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>createdAt<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>image<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> double innerPadding <span class="token operator">=</span> <span class="token number">12.0</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Timestamp</span><span class="token operator">?</span> createdAt<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token operator">?</span> title<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token operator">?</span> content<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token operator">?</span> image<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> <span class="token class-name">ColorScheme</span> colorScheme <span class="token operator">=</span> <span class="token class-name">Theme</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>colorScheme<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
      mainAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">MainAxisAlignment</span><span class="token punctuation">.</span>center<span class="token punctuation">,</span>
      crossAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">CrossAxisAlignment</span><span class="token punctuation">.</span>start<span class="token punctuation">,</span>
      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">_UpperDatePortion</span><span class="token punctuation">(</span>
          padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
          child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>
            <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token punctuation">$&#123;</span><span class="token expression"><span class="token class-name">DateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>createdAt<span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day</span><span class="token punctuation">&#125;</span></span><span class="token string">일"</span></span><span class="token punctuation">,</span>
            style<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>fontWeight<span class="token punctuation">:</span> <span class="token class-name">FontWeight</span><span class="token punctuation">.</span>bold<span class="token punctuation">,</span> fontSize<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">ConstrainedBox</span><span class="token punctuation">(</span>
          constraints<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">BoxConstraints</span><span class="token punctuation">(</span>maxHeight<span class="token punctuation">:</span> <span class="token number">270</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">:</span> <span class="token number">325</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          child<span class="token punctuation">:</span> <span class="token class-name">Card</span><span class="token punctuation">(</span>
            color<span class="token punctuation">:</span> colorScheme<span class="token punctuation">.</span>surface<span class="token punctuation">.</span><span class="token function">withOpacity</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            elevation<span class="token punctuation">:</span> <span class="token number">3.0</span><span class="token punctuation">,</span>
            child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
              crossAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">CrossAxisAlignment</span><span class="token punctuation">.</span>start<span class="token punctuation">,</span>
              children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token function">_ImagePortion</span><span class="token punctuation">(</span>padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span> url<span class="token punctuation">:</span> image<span class="token punctuation">)</span><span class="token punctuation">,</span>
                title <span class="token operator">!=</span> <span class="token keyword">null</span>
                    <span class="token operator">?</span> <span class="token class-name">Padding</span><span class="token punctuation">(</span>
                        padding<span class="token punctuation">:</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">symmetric</span><span class="token punctuation">(</span>horizontal<span class="token punctuation">:</span> innerPadding<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>
                          title<span class="token operator">!</span><span class="token punctuation">,</span>
                          style<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>
                            fontSize<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
                            fontWeight<span class="token punctuation">:</span> <span class="token class-name">FontWeight</span><span class="token punctuation">.</span>bold<span class="token punctuation">,</span>
                          <span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token punctuation">)</span><span class="token punctuation">,</span>
                      <span class="token punctuation">)</span>
                    <span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">SizedBox</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_TextPortion</span><span class="token punctuation">(</span>
                  padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
                  child<span class="token punctuation">:</span> <span class="token class-name">RichText</span><span class="token punctuation">(</span>
                      maxLines<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                      overflow<span class="token punctuation">:</span> <span class="token class-name">TextOverflow</span><span class="token punctuation">.</span>ellipsis<span class="token punctuation">,</span>
                      text<span class="token punctuation">:</span> <span class="token class-name">TextSpan</span><span class="token punctuation">(</span>
                          style<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> colorScheme<span class="token punctuation">.</span>onSurfaceVariant<span class="token punctuation">)</span><span class="token punctuation">,</span>
                          text<span class="token punctuation">:</span> content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token class-name">Divider</span><span class="token punctuation">(</span>
                  indent<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                  endIndent<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_DatePortion</span><span class="token punctuation">(</span>
                  padding<span class="token punctuation">:</span> innerPadding<span class="token punctuation">,</span>
                  date<span class="token punctuation">:</span> <span class="token class-name">DateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  onEdit<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">debugPrint</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Hello"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <h1 id="sources" data-svelte-h="svelte-22jvrw">Sources</h1> <p data-svelte-h="svelte-1ceryc7"><a href="https://riverpod.dev" rel="nofollow">Riverpod 공식문서</a></p> </div></div> </div> 
			
			<script>
				{
					__sveltekit_fflaah = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":{tags:new Set(["Dart","Flutter","SvelteKit","Mdsvex","Github"])},"uses":{}},null];

					Promise.all([
						import("../_app/immutable/entry/start.Bt011eEk.js"),
						import("../_app/immutable/entry/app.3KgnaAzN.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
	<script src="https://kit.fontawesome.com/56837ace2e.js" crossorigin="anonymous"></script>
</html>
