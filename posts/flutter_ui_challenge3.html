<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<link rel="stylesheet" href="/styles/app.css" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.xOjPe-y_.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.CIgjqQMH.css" rel="stylesheet">
		<link href="../_app/immutable/assets/ArticleMeta.VMQ7KKaF.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.CWvWDUsL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.Dj2fVEVr.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.B-IchvsE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.DrnUf5mb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.BjaxA5q6.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.D0j5BQgR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/each.D6YF6ztN.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DFA_Jgpq.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.CzR0xuCU.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/PageHead.CPg4SRpn.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/ArticleMeta.CDddU60r.js"><title>Flutter UI Challenge(3) | SvelteKit + MDsveX Blog</title><!-- HEAD_svelte-1jfag13_START --><meta property="og:site_name" content="SvelteKit + MDsveX Blog"><meta property="og:title" content="Flutter UI Challenge(3)"><meta property="og:description" content="Learn some advanced usage of StatefulWidget, Widget builder, AnimatedWidget, and Transform."><!-- HEAD_svelte-1jfag13_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">  <div class="header-container svelte-1el8ei0"><div class="sidebarNavBtn svelte-1el8ei0"><button data-svelte-h="svelte-1w5a5mz"><i class="fa-solid fa-bars"></i></button></div>   <div class="svelte-149edha"><a href="/"><h1 class="small" data-svelte-h="svelte-9gkbac">Jack.dev.blog</h1></a> </div></div> <div class="sidebar-and-main svelte-1el8ei0"><div class="sidebar-container svelte-1el8ei0"><aside class="w-64" aria-label="Sidebar"><div class="overflow-y-auto py-4 px-3 bg-gray-50 rounded dark:bg-gray-800"><ul class="space-y-2 list-none"><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Flutter"> <span class="ms-3">Flutter</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Dart"> <span class="ms-3">Dart</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/SvelteKit"> <span class="ms-3">SvelteKit</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Mdsvex"> <span class="ms-3">Mdsvex</span> </a></li>  <hr><li><a class="flex items-center p-2 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 m-1 text-xl font-semibold text-black" href="/tags/Github"> <span class="ms-3">Github</span> </a></li>  <hr></ul> </div> </aside> </div> <div class="main svelte-1el8ei0"> <div class="metadata svelte-bu3nzg"><h2 class="heading svelte-1ujuesn large" id="flutter-ui-challenge"><a href="#flutter-ui-challenge">Flutter UI Challenge(3)</a></h2> <p class="svelte-1uy9i9h"><div class="tags svelte-1uy9i9h"><span data-svelte-h="svelte-190wkx9">Tags:</span> <div class="tag-items-container svelte-1uy9i9h"><span class="tag svelte-1uy9i9h">Flutter</span></div></div></p> <div class="metadata svelte-1uy9i9h"><span class="date svelte-1uy9i9h">2024. 10. 16. (수)</span> </div></div> <div class="component svelte-bu3nzg"><nav class="toc" data-svelte-h="svelte-1pz5i83"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#widget-구성">Widget 구성</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#homepage">HomePage</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#globalkey">GlobalKey</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#pageflipbuilder">PageFlipBuilder</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#required-properties">Required properties</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#default-value-properties">Default value properties</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#pageflipbuilderstate">PageFlipBuilderState</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#animatedpageflipbuilder">AnimatedPageFlipBuilder</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#required-properties-1">Required properties</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#default-value-properties-1">Default value properties</a></li></ol></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#내부-메서드-세부-구현">내부 메서드 세부 구현</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#pageflipbuilderstate-1">PageFlipBuilderState</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#animatedpageflipbuilder-1">AnimatedPageFlipBuilder</a></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#sources">Sources</a></li></ol></nav> <hr> <p data-svelte-h="svelte-1vjr62z">글을 일기전에 문제를 먼저 고민해보고 andrea의 예시 답안을 보고나서 읽기를 추천드립니다!</p> <p data-svelte-h="svelte-1g5aolc"><img src="/ui3_1.png" alt="ui3_1"> <img src="/ui3_2.png" alt="ui3_2"></p> <p data-svelte-h="svelte-15thsav">pro.codewithandrea.com 의 flutter ui challenge 3번째 문제입니다.(<a href="https://pro.codewithandrea.com/flutter-ui-challenges/003-page-flip/01-intro" rel="nofollow">링크</a>)</p> <p data-svelte-h="svelte-4v5zw">구현하고자 하는 것은 앞뒤에 서로 다른 그림이 있는 페이지를 만들고 버튼과 drag gesture을 통해 앞과 뒤가 바뀌는 애니메이션을 넣는 것입니다.</p> <p data-svelte-h="svelte-1frj6a1">구현 목표는 다음과 같습니다.</p> <ul data-svelte-h="svelte-1u2rx63"><li>PageFlipBuilder stateful widget 만들기</li> <li>AnimationController 과 AnimatedWidget 을 이용해 뒤집는 애니메이션을 구현하고 버튼을 눌렀을 때 작동되도록 onFlip 콜백에 등록</li> <li>Transform widget을 이용해 페이지가 회전하는 듯한 효과 주기</li> <li>transform 시 tilt 값을 이용해 3D처럼 보이도록하기</li> <li>GestureDetector를 이용해 drag 제스처 감지 및 로직 구현하기</li> <li>AnimationController의 상한값을 1로 하한값을 -1로 설정하기</li> <li>“fling” 을 이용해 좀 더 물리적으로 좀 더 실감나는 애니메이션 구현</li> <li>위젯의 구성을 설계할 때 변화와 edge case에 대응 할 수 있는 코드로 설계할 것.</li></ul> <h1 id="widget-구성" data-svelte-h="svelte-49igd3">Widget 구성</h1> <p data-svelte-h="svelte-1f069em"><img src="/widget_tree.png" alt="widget_tree"></p> <h2 id="homepage" data-svelte-h="svelte-izm64m">HomePage</h2> <h3 id="globalkey" data-svelte-h="svelte-nzukjo">GlobalKey</h3> <blockquote data-svelte-h="svelte-jmsc1r"><p>Global keys uniquely identify elements. Global keys <strong>provide access</strong> to other objects that are associated with those elements, such as <strong>BuildContext</strong>. For StatefulWidgets, global keys also provide access to <strong>State</strong>.</p></blockquote> <p data-svelte-h="svelte-1hlhqoj">onFlip의 구현이 StatelessWidget인 LightHomePage 혹은 DarkHomePage에 없음.</p> <p data-svelte-h="svelte-1tgdsxk">만약 LightHomePage 혹은 DarkHomePage 안에서 onFlip을 구현하려고 한다면 다음과 같은 문제가 생김</p> <ol data-svelte-h="svelte-o0irko"><li><strong>코드가 중복</strong></li> <li><strong>animation controller를 사용하기 위해서 구조자체를 바꿔야함</strong></li> <li><strong>요구사항 변경에 대응하기 어려움</strong></li></ol> <p data-svelte-h="svelte-me9or8">확장성있고 재활용 가능한 위젯으로 활용하기 위해서는 위처럼 Key를 이용해 State 안에서 onFlip을 정의해서 사용하는 것이 좋음.</p> <h2 id="pageflipbuilder" data-svelte-h="svelte-1ckibqo">PageFlipBuilder</h2> <h3 id="required-properties" data-svelte-h="svelte-ji3bap">Required properties</h3> <ul data-svelte-h="svelte-addkgk"><li><p><strong>frontBuilder &amp; backBuilder</strong> :</p> <p>frontBuilder 와 backBuilder를 이용해 보여주고자하는 페이지를 유동적으로 변경할 수 있음.</p> <p>코드에서 사용되는 builder는 정확히는 Builder 위젯을 의미하는게 아니라 WidgetBuilder typedef를 사용함.</p></li></ul> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token class-name">WidgetBuilder</span> <span class="token operator">=</span> <span class="token class-name">Widget</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <blockquote data-svelte-h="svelte-1f45w3m"><p>Signature for a function that creates a widget, e.g. StatelessWidget.build or State.build</p></blockquote> <h3 id="default-value-properties" data-svelte-h="svelte-1k5mfic">Default value properties</h3> <ul data-svelte-h="svelte-19uo36c"><li><p><strong>nonInteractiveAnimationDuration</strong></p> <p>defaults to const Duration(milliseconds: 500)</p> <p>animation이 진행되는 시간. controller.begin ~ controller.end 까지의 애니메이션이 500ms동안 진행됨.</p></li> <li><p><strong>interactiveFlipEnabled</strong></p> <p>defaults to true</p> <p>interactiveFlipEnabled가 true일 경우에만 drag gesture를 이용한 화면 전환 허용</p></li> <li><p><strong>flipAxis</strong></p> <p>defaults to Axis.vertical</p> <p>화면 전환 시 사용되는 회전축.</p> <p>현재 기본값은 Axis.vertical로 화면상 y축이 회전축이 되어 화면을 전환</p></li> <li><p><strong>maxTilt</strong></p> <p>defaults to 0.003</p> <p>Transform 위젯 사용시 tilt효과에 적용될 값. tilt는 직역하자면 기울인다는 뜻인데 시점을 보정해주는 역할을 합니다.</p> <p>예를 들어 100 x 100 사이즈의 박스를 y축을 기준으로 45도 기울일 경우 생각과는 일반적으로 예상하는 결과와는 다른 상황이 벌어집니다.</p></li></ul> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token class-name">Transform</span><span class="token punctuation">(</span>
	transform<span class="token punctuation">:</span> <span class="token class-name">Matrix4</span><span class="token punctuation">.</span><span class="token function">rotationY</span><span class="token punctuation">(</span>pi <span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	child<span class="token punctuation">:</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>
		width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		height<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		decoration<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">BoxDecoration</span><span class="token punctuation">(</span>
			color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>black
		<span class="token punctuation">)</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-wjwqny"><img src="/tilt1.png" alt="tilt1"></p> <p data-svelte-h="svelte-1wf0nuz">하지만 tilt값을 설정해준다면 다음과 같이 기울기가 적용되어 실제 3D상에서 45도를 기울인것 같은 결과를 볼수 있습니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token class-name">Transform</span><span class="token punctuation">(</span>
	transform<span class="token punctuation">:</span> <span class="token class-name">Matrix4</span><span class="token punctuation">.</span><span class="token function">rotationY</span><span class="token punctuation">(</span>pi <span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">setEntry</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.003</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	child<span class="token punctuation">:</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>
		width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		height<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		decoration<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">BoxDecoration</span><span class="token punctuation">(</span>
			color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>black
		<span class="token punctuation">)</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1ezmoam"><img src="/tilt2.png" alt="tilt2"></p> <p data-svelte-h="svelte-1vd733q">tilt값을 설정해준다고 하면서 실제로 한 것은 Matrix4의 3행, 0열에 0.003을 넣어준것입니다.</p> <p data-svelte-h="svelte-1al0ka9">이게 어떻게 tilt값을 설정해준다는 것일까요?</p> <p data-svelte-h="svelte-7who5e">우선 Flutter가 어떤식으로 화면의 한 점을 나타내는지 알아야 합니다.</p> <p data-svelte-h="svelte-1e53hh2">Flutter는 기본적으로 모든 화면을 3d공간상의 좌표로 표현하는데, 좌표의 한 점을 표현할 때 x값, y값, z값 에 추가로 한 가지 값을 더 넣어서 <strong>4개의 값으로 한 점을 표현</strong>합니다.</p> <p data-svelte-h="svelte-1cjg5e3">이런식으로 좌표를 표현하는 것을 동차좌표(homogeneous coordinates)라고 합니다.</p> <p data-svelte-h="svelte-13nzp75">예를 들어 한 점(a, b, c)은 (aw, bw, cw, w)로 표현합니다. w값이 1이라면 (a, b, c, 1) 이 되는 식입니다.</p> <p data-svelte-h="svelte-17tqmuq">따라서, Flutter가 그려내는 화면의 어떤 한 점은 1 x 4 모양의 행렬이됩니다. (사실은 4 x 1 행렬입니다.)</p> <p data-svelte-h="svelte-55q4jl"><strong>Matrix4</strong>는 보이는 화면의 특정한 한 점을 나타내는 것이 아니라 어떤 요소에 적용할 <strong>변환(transform) 행렬(matrix)</strong>입니다.</p> <p data-svelte-h="svelte-yu70ta">예를 들어, Matrix4.rotationY(pi/4) 는 pi /4 radian (45도) 만큼 y축을 기준으로 회전시키는 변환을 나타내는 4x4 행렬입니다.</p> <p data-svelte-h="svelte-1hrpysp">다음은 이 Matrix4의 각 부분이 어떤 변환을 나타내는지 알 수 있는 간단한 그림입니다.</p> <p data-svelte-h="svelte-nexbwe"><img src="/Matrix4.png" alt="Matrix4"></p> <ul data-svelte-h="svelte-fhmpsx"><li><p><strong>maxScale</strong></p> <p>0.2</p> <p>스케일 즉, 확대 또는 축소하는 효과를 줄 수 있습니다.</p> <p>값이 1보다 크면 확대, 작으면 축소한다고 생각할 수 있습니다.</p></li></ul> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">AnimatedPageFlipBuilder</span> <span class="token keyword">extends</span> <span class="token class-name">AnimatedWidget</span> <span class="token punctuation">&#123;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">return</span> <span class="token class-name">Transform</span><span class="token punctuation">(</span>
		transform<span class="token punctuation">:</span> matrix <span class="token operator">*</span> <span class="token class-name">Matrix4</span><span class="token punctuation">.</span><span class="token function">diagonal3Values</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <ul data-svelte-h="svelte-1ktf6ex"><li><p><strong>onFlipComplete</strong></p> <p>optional</p> <p>onFlipComplete는 필수값은 아닙니다. 현재는 디버깅을 위해 showFrontSide 상태를 로그에 찍어주는 콜백을 사용했습니다.</p></li></ul> <h2 id="pageflipbuilderstate" data-svelte-h="svelte-1lawwni">PageFlipBuilderState</h2> <ul data-svelte-h="svelte-1syd28q"><li><p><strong>showFrontSide</strong></p></li> <li><p><strong>wasFrontSide</strong></p></li></ul> <h2 id="animatedpageflipbuilder" data-svelte-h="svelte-roth3i">AnimatedPageFlipBuilder</h2> <h3 id="required-properties-1" data-svelte-h="svelte-fm1yer">Required properties</h3> <ul data-svelte-h="svelte-1ui0h8r"><li><p><strong>showFrontSide</strong></p></li> <li><p><strong>frontBuilder &amp; backBuilder</strong></p></li></ul> <h3 id="default-value-properties-1" data-svelte-h="svelte-in9v3a">Default value properties</h3> <ul data-svelte-h="svelte-6ll7ry"><li><p><strong>flipAxis</strong></p></li> <li><p><strong>maxTilt</strong></p></li> <li><p><strong>maxScale</strong></p></li></ul> <h1 id="내부-메서드-세부-구현" data-svelte-h="svelte-1qy1qob">내부 메서드 세부 구현</h1> <h2 id="pageflipbuilderstate-1" data-svelte-h="svelte-17e80lo">PageFlipBuilderState</h2> <p data-svelte-h="svelte-1wbyb5w"><strong>flip</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">void</span> <span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	_wasFrontSide <span class="token operator">=</span> _showFrontSide<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_showFrontSide<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		_controller<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		_controller<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-qn2bsi">flip은 wasFrontSide와 showFrontSide를 property를 이용해 현재 보여지는 페이지의 상태를 바꿔주는 콜백함수입니다.</p> <p data-svelte-h="svelte-aynepf">로직자체는 어렵지 않지만 왜 이렇게 썼는지 바로 이해하기엔 헷갈릴 수 있습니다.</p> <p data-svelte-h="svelte-1przbta">showFrontSide 가 true라면 controller.forward 즉, 페이지를 뒤집는 애니메이션이 실행됩니다.</p> <p data-svelte-h="svelte-lrq2yy">애니메이션은 다음의 4가지 상태값을 갖습니다.</p> <ul data-svelte-h="svelte-1kap2p"><li><strong>dismissed</strong> : animation이 <strong>시작 지점</strong>에서 <strong>멈췄을 때</strong></li> <li><strong>forward</strong> : animation이 <strong>시작지점</strong>에서 <strong>끝지점</strong>으로 <strong>진행중</strong> 일 때</li> <li><strong>reverse</strong> : animation이 <strong>끝지점</strong>에서 <strong>시작지점</strong>으로 <strong>진행중</strong> 일 때</li> <li><strong>completed</strong> : animation이 <strong>끝지점</strong>에서 <strong>멈췄을 때</strong></li></ul> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	late <span class="token keyword">final</span> <span class="token class-name">AnimationController</span> _controller<span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token metadata function">@override</span>
	<span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	_controller <span class="token operator">=</span> <span class="token class-name">AnimationController</span><span class="token punctuation">(</span>
		vsync<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
		duration<span class="token punctuation">:</span> widget<span class="token punctuation">.</span>nonInteractiveAnimationDuration<span class="token punctuation">,</span>
		lowerBound<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>
		upperBound<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
	_controller<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
	_controller<span class="token punctuation">.</span><span class="token function">addStatusListener</span><span class="token punctuation">(</span>_updateStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-19rdpfg">현재 PageFlipBuilderState의 animation controller는 다음과 같은 status listener를 갖고 있습니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">void</span> <span class="token function">_updateStatus</span><span class="token punctuation">(</span><span class="token class-name">AnimationStatus</span> status<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token class-name">AnimationStatus</span><span class="token punctuation">.</span>completed <span class="token operator">||</span>
		status <span class="token operator">==</span> <span class="token class-name">AnimationStatus</span><span class="token punctuation">.</span>dismissed<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		_controller<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
		<span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> _showFrontSide <span class="token operator">=</span> <span class="token operator">!</span>_showFrontSide<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_wasFrontSide <span class="token operator">!=</span> _showFrontSide<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			_wasFrontSide <span class="token operator">=</span> _showFrontSide<span class="token punctuation">;</span>
			widget<span class="token punctuation">.</span>onFlipComplete<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>_showFrontSide<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-5wwi8a">현재의 애니메이션의 상태가 completed(forward 완료) 혹은 dismissed(reverse 완료)가 됐을 때, 즉 완전한 페이지 전환이 한차례 이루어졌을 때 showFrontSide값을 반대로 바꾸어주고 있습니다.</p> <p data-svelte-h="svelte-1ptxl9t">만약 GestureDetector가 없이 버튼으로만 페이지를 전환했다면 showFrontSide값을 바꾸는 로직이 flip에 있어도 되지만, 지금처럼 버튼 이외의 요소가 상태(showFrontSide)를 변경할 수 있는 환경에서는 해당 상태가 결정되는 지점에서 로직을 구현해야합니다.</p> <p data-svelte-h="svelte-18st2ct">그런데 애초에 wasFrontSide와 showFrontSide 변수는 왜 필요할까요?</p> <p data-svelte-h="svelte-ox95zt">flip상태를 보기 위해서라면 showFrontSide 하나만 있어도 충분할 것 같습니다.</p> <p data-svelte-h="svelte-jqdd7n">wasFrontSide는 updateStatus 함수의 마지막 줄때문에 필요합니다.
<code>widget.onFlipComplete?.call(\_showFrontside);</code></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">class</span> <span class="token class-name">PageFlipBuilder</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">&#123;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token class-name">Function</span><span class="token punctuation">(</span>bool<span class="token punctuation">)</span><span class="token operator">?</span> onFlipComplete<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1bv9s94">PageFlipBuilder는 flip이 완료됐을 때 최종적으로 실행시킬 함수를 가질 수 있습니다.</p> <p data-svelte-h="svelte-17tavft">함수의 이름처럼 flip이 완료됐을 때를 판단하기 위해서는 현재 보여지는 페이지가 이전 페이지와는 다른 페이지라는 정보를 알아야 하기 때문에 wasFrontSide가 필요하게 된 것입니다.</p> <hr> <p data-svelte-h="svelte-1b62mbg"><strong>GestureDetector callbacks</strong></p> <p data-svelte-h="svelte-1j88iwt">GestureDetector는 이름처럼 스크린에 감지되는 행동에 반응할 수 있는 widget입니다.</p> <p data-svelte-h="svelte-1rmo7d6">다양한 제스처들이 있지만 지금 하고자 하는 것은 <strong>수평(horizontal)</strong>으로 혹은 <strong>수직(vertical)</strong>으로 <strong>잡아끄는(drag)</strong> 모션을 감지하고 그에 맞게 페이지를 뒤집는듯한 애니메이션을 넣고 싶습니다.</p> <p data-svelte-h="svelte-1jntpz6">이를 위해선 GestureDetector에 다음과 같은 콜백을 등록해주어야합니다.</p> <ul data-svelte-h="svelte-puui94"><li><p><strong>GestureDragStartCallback?</strong> onHorizontalDragStart</p></li> <li><p><strong>GestureDragUpdateCallback?</strong> onHorizontalDragUpdate</p></li> <li><p><strong>GestureDragEndCallback?</strong> onHorizontalDragEnd</p></li> <li><p><strong>GestureDragStartCallback?</strong> onVerticalDragStart</p></li> <li><p><strong>GestureDragUpdateCallback?</strong> onVerticalDragUpdate</p></li> <li><p><strong>GestureDragEndCallback?</strong> onVerticalEnd</p> <p>이 콜백함수들은 해당 제스처에 맞는 로직을 구현하기 위한 <strong>상세값(detail)</strong>을 파라미터로 갖습니다.</p> <p>예를 들어 <strong>GestureDragUpdateCallback은</strong> DragUpdateDetails 를 파라미터로 갖습니다.</p></li></ul> <blockquote data-svelte-h="svelte-mxb7ke"><p><code>GestureDragUpdateCallback = void Function(DragUpdateDetails details)</code></p></blockquote> <p data-svelte-h="svelte-djkvyd">이 detail이 제공하는 값들을 가지고 적절하게 애니메이션을 컨트롤하는 로직을 구현하면 되는데 다음의 3가지 함수가 그 역할을 하고 있습니다.</p> <p data-svelte-h="svelte-1bhckct"><strong>handleDragStart</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">void</span> <span class="token function">_handleDragStart</span><span class="token punctuation">(</span><span class="token class-name">DragStartDetails</span> details<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	_wasFrontSide <span class="token operator">=</span> _showFrontSide<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1i4dbfo">DragGesture가 시작될 때 wasFrontSide의 값을 showFrontSide로 업데이트해줍니다.</p> <p data-svelte-h="svelte-1idhhh6"><strong>handleDragUpdate</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">void</span> <span class="token function">_handleDragUpdate</span><span class="token punctuation">(</span><span class="token class-name">DragUpdateDetails</span> details<span class="token punctuation">,</span> double crossAxisLength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  _controller<span class="token punctuation">.</span>value <span class="token operator">+=</span> details<span class="token punctuation">.</span>primaryDelta<span class="token operator">!</span> <span class="token operator">/</span> crossAxisLength<span class="token punctuation">;</span>
  <span class="token function">debugPrint</span><span class="token punctuation">(</span><span class="token punctuation">(</span>details<span class="token punctuation">.</span>primaryDelta<span class="token operator">!</span> <span class="token operator">/</span> crossAxisLength<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1vsefnd">controller 시작 지점 값과 끝 지점의 값을 갖는 애니메이션입니다.</p> <p data-svelte-h="svelte-1734jq2">시작 지점은 0이고 끝지점은 처음 controller를 만들때 1(upperBound) 또는 -1(lowerBound)로 설정해주었습니다.</p> <p data-svelte-h="svelte-1tzqzqz"><strong>primaryDelta</strong>는 이전 업데이트로부터 마우스(또는 손가락)가 메인 축을 따라(horizontal drag일 경우 x축) <strong>얼마만큼 움직였는지</strong>를 알려줍니다.</p> <p data-svelte-h="svelte-gbxc8m">primaryDelta 값을 <strong>crossAxisLength</strong>로 나누어주고 있는데 crossAxisLength는 <strong>horizontal drag일 경우 x축의 max width</strong>, <strong>vertical drag일 경우 y축의 max height</strong>이 됩니다.
현재 코드상 crossAxisLength는 다음과 같이 구해집니다.</p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">final</span> crossAxisLength <span class="token operator">=</span> isHorizontal <span class="token operator">?</span> constraints<span class="token punctuation">.</span>maxWidth <span class="token punctuation">:</span> constraints<span class="token punctuation">.</span>maxHeight<span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-11uo7js">(변수명을 좀 헷갈리게 만든것 같긴 하네요..^^; )</p> <p data-svelte-h="svelte-1k7woh8">primaryDelta값을 crossAxisLength값으로 나눠주는 이유는 <strong>정규화</strong>를 해주기 위해서입니다.</p> <p data-svelte-h="svelte-5pwziw">값을 <strong>0~1사이로 보정</strong>해 다른 사이즈의 스크린에서도 동일한 애니메이션 효과를 얻을 수 있습니다.</p> <p data-svelte-h="svelte-u1uyf3">controller.value에 값을 누적해서 더하고 있는데 <strong>upperBound</strong>, <strong>lowerBound</strong>가 설정되어 있기 때문에 범위를 넘어설 걱정은 안해도 됩니다.</p> <p data-svelte-h="svelte-1g9pzls"><strong>handleDragEnd</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart"><span class="token keyword">void</span> <span class="token function">_handleDragEnd</span><span class="token punctuation">(</span><span class="token class-name">DragEndDetails</span> details<span class="token punctuation">,</span> double crossAxisLength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>isAnimating <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token class-name">AnimationStatus</span><span class="token punctuation">.</span>completed <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token class-name">AnimationStatus</span><span class="token punctuation">.</span>dismissed<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> velocityThreshold <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> velocity <span class="token operator">=</span> widget<span class="token punctuation">.</span>flipAxis <span class="token operator">==</span> <span class="token class-name">Axis</span><span class="token punctuation">.</span>horizontal
      <span class="token operator">?</span> details<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>pixelsPerSecond<span class="token punctuation">.</span>dx
      <span class="token punctuation">:</span> details<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>pixelsPerSecond<span class="token punctuation">.</span>dy<span class="token punctuation">;</span>
  <span class="token keyword">final</span> flingVelocity <span class="token operator">=</span> velocity <span class="token operator">/</span> crossAxisLength<span class="token punctuation">;</span>

  <span class="token comment">// if value and velocity are 0, the gesture was a tap so we return early</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> flingVelocity <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0.5</span> <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> flingVelocity <span class="token operator">></span> velocityThreshold<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    _controller<span class="token punctuation">.</span><span class="token function">fling</span><span class="token punctuation">(</span>velocity<span class="token punctuation">:</span> velocityThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> flingVelocity <span class="token operator">&lt;</span> <span class="token operator">-</span>velocityThreshold<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    _controller<span class="token punctuation">.</span><span class="token function">fling</span><span class="token punctuation">(</span>velocity<span class="token punctuation">:</span> <span class="token operator">-</span>velocityThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0.0</span> <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0.5</span> <span class="token operator">&amp;&amp;</span> flingVelocity <span class="token operator">&lt;</span> <span class="token operator">-</span>velocityThreshold<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// controller can't fling to 0.0 because the lowerBound is -1.0</span>
    <span class="token comment">// so we decrement the value by 1.0 and toggle the state to get the same effect    _controller.value -= 1.0;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> _showFrontSide <span class="token operator">=</span> <span class="token operator">!</span>_showFrontSide<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _controller<span class="token punctuation">.</span><span class="token function">fling</span><span class="token punctuation">(</span>velocity<span class="token punctuation">:</span> <span class="token operator">-</span>velocityThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_controller<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">||</span>
      _controller<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">&amp;&amp;</span> flingVelocity <span class="token operator">></span> velocityThreshold<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// controller can't fling to 0.0 because the upperBound is 1.0</span>
    <span class="token comment">// so we increment the value by 1.0 and toggle the state to get the same effect    _controller.value += 1.0;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> _showFrontSide <span class="token operator">=</span> <span class="token operator">!</span>_showFrontSide<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _controller<span class="token punctuation">.</span><span class="token function">fling</span><span class="token punctuation">(</span>velocity<span class="token punctuation">:</span> velocityThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-5mn9yp">사용자가 drag gesture를 종료하는 시점에 호출될 callback입니다.</p> <p data-svelte-h="svelte-1gr9utn">여러가지 상황에 대해 케이스를 분류하여 실행될 로직을 구현해놨습니다.</p> <p data-svelte-h="svelte-tqdsr6">드래그를 하다가 어떤 시점에 마우스(또는 손가락)를 화면에서 떼면 페이지를 다시 원점으로(드래그 하기 직전으로) 되돌리는 애니메이션(fling)을 실행시키도록 합니다.</p> <p data-svelte-h="svelte-br48en"><strong>fling은</strong> <strong>velocity</strong>값을 파라미터로 받습니다.</p> <p data-svelte-h="svelte-eba1bg">velocity가 양수일 경우 animation forward, 음수일 경우 animation reverse 한다고 생각할 수 있습니다.</p> <p data-svelte-h="svelte-1gi78u4"><strong>velocityThreshold</strong>는 얼마나 빠르게 드래그 했냐를 판단하는 기준값입니다.</p> <p data-svelte-h="svelte-1f9oynm">현재는 pixelsPerSecond / crossAxisLength 값을 이용해 2(velocityThreshold)보다 큰지 작은지를 보아 빠르냐 느리냐를 판단하고 있습니다.</p> <p data-svelte-h="svelte-6knmx7">가능한 상황은 다음과 같습니다.</p> <ol data-svelte-h="svelte-83sk3r"><li><strong>fling 애니메이션이 실행될 필요가 없는 경우.</strong></li> <li><strong>fling 애니메이션이 필요한 경우</strong><ol><li>화면을 <strong>180도 넘게 돌렸거나</strong> 혹은 <strong>매우 빠르게 우측으로 drag</strong>한 경우</li> <li>화면을 <strong>-180도 넘게 돌렸거나</strong> 혹은 <strong>매우 빠르게 좌측으로 drag</strong>한 경우</li> <li>화면을 <strong>0~180도 돌렸거나</strong> 혹은 <strong>180도 넘게 돌렸으나 다시 좌측으로 매우 빠르게 drag</strong>한 경우</li> <li>화면을 <strong>-180 ~ 0도 돌렸거나</strong> 혹은 <strong>-180도 넘게 돌렸으나 다시 우측으로 매우 빠르게 drag</strong>한 경우</li></ol></li></ol> <hr> <h2 id="animatedpageflipbuilder-1" data-svelte-h="svelte-1fal5ww">AnimatedPageFlipBuilder</h2> <p data-svelte-h="svelte-kw7v0a">controller의 animation이 진행됨에 따라 어떻게 Transform을 적용할지를 정해주는 부분입니다.</p> <p data-svelte-h="svelte-1ihs1um"><strong>getTilt</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">double <span class="token function">_getTilt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> tilt <span class="token operator">=</span> <span class="token punctuation">(</span>animation<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>animation<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    tilt <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">+</span> animation<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> tilt <span class="token operator">*</span> <span class="token punctuation">(</span>_isAnimationFirstHalf <span class="token operator">?</span> <span class="token operator">-</span>maxTilt <span class="token punctuation">:</span> maxTilt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-oghzdc"><strong>rotationAngle</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">double <span class="token function">_rotationAngle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">final</span> rotationValue <span class="token operator">=</span> animation<span class="token punctuation">.</span>value <span class="token operator">*</span> pi<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>animation<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> pi <span class="token operator">-</span> rotationValue<span class="token punctuation">;</span> <span class="token comment">// input from 0.5 to 1.0</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>animation<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> rotationValue<span class="token punctuation">;</span> <span class="token comment">// input from -0.5 to 0.5</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>pi <span class="token operator">-</span> rotationValue<span class="token punctuation">;</span> <span class="token comment">// input from -1.0 to -0.5</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-o82oin"><strong>scale</strong></p> <pre class="language-dart"><!-- HTML_TAG_START --><code class="language-dart">double <span class="token function">_scale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">final</span> absValue <span class="token operator">=</span> animation<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token operator">-</span> <span class="token punctuation">(</span>absValue <span class="token operator">&lt;</span> <span class="token number">0.5</span> <span class="token operator">?</span> absValue <span class="token punctuation">:</span> <span class="token number">1.0</span> <span class="token operator">-</span> absValue<span class="token punctuation">)</span> <span class="token operator">*</span> maxScale<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <hr> <p data-svelte-h="svelte-p4acps">보이는 것과는 달리 생각보다 어려운 문제였습니다.</p> <p data-svelte-h="svelte-bcg5tm">단순하게 한번 실행되고 종료되는 애니메이션이 아니기 때문에 ticker 하나만으로는 구현이 어렵습니다.</p> <p data-svelte-h="svelte-t0ewa0">유저의 입력이 어떤 식으로 들어올지 각 케이스를 자세하게 분류해야 하며,</p> <p data-svelte-h="svelte-1usyvm5">실감나는 3D 애니메이션을 만들기 위해 적절한 변환을 적용해주어야 합니다.</p> <p data-svelte-h="svelte-1189hx0">구현 과정에서는 변동 가능성을 염두에 두고 위젯의 유연한 설계를 위한 고민도 필요했습니다.</p> <p data-svelte-h="svelte-19ibeqg">andrea의 예시 답안을 나름대로 분석해보며 많이 배우는 시간이었습니다.</p> <h1 id="sources" data-svelte-h="svelte-22jvrw">Sources</h1> <p data-svelte-h="svelte-1sel7uf"><a href="https://pro.codewithandrea.com/flutter-ui-challenges/003-page-flip/01-intro" rel="nofollow">Andrea Flutter Challenge 3</a></p> <p data-svelte-h="svelte-12s2ysj"><a href="https://api.flutter.dev/flutter/widgets/GlobalKey-class.html" rel="nofollow">GlobalKey</a></p> <p data-svelte-h="svelte-1rl8o5h"><a href="https://api.flutter.dev/flutter/widgets/AnimatedWidget-class.html" rel="nofollow">AnimatedWidget</a></p> <p data-svelte-h="svelte-1amdb7d"><a href="https://api.flutter.dev/flutter/widgets/WidgetBuilder.html" rel="nofollow">WidgetBuilder typedef</a></p> <p data-svelte-h="svelte-15kvfen"><a href="https://api.flutter.dev/flutter/vector_math_64/Matrix4-class.html" rel="nofollow">Matrix4</a></p> <p data-svelte-h="svelte-2svh7p"><a href="https://darkpgmr.tistory.com/78" rel="nofollow">homogeneous coordinates</a></p> <p data-svelte-h="svelte-13gqejf"><a href="https://medium.com/flutter-community/a-deep-dive-into-transform-widgets-in-flutter-4dc32cd575a9" rel="nofollow">Flutter Transform</a></p> </div></div> </div> 
			
			<script>
				{
					__sveltekit_drpq6x = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":{tags:new Set(["Flutter","Dart","SvelteKit","Mdsvex","Github"])},"uses":{}},null];

					Promise.all([
						import("../_app/immutable/entry/start.CWvWDUsL.js"),
						import("../_app/immutable/entry/app.DrnUf5mb.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
	<script src="https://kit.fontawesome.com/56837ace2e.js" crossorigin="anonymous"></script>
</html>
